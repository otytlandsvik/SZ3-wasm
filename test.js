// Compress
let data = [
  0.567864878, 1.1456767867, 1.11111164787, 754.96969674564, 6.96969, 2.34567,
  8.76543, 9.12345, 0.5678, 1.14567, 1.11111, 7.96969, 6.96969, 2.34567,
  8.76543, 9.12345, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  9.02345, 0.13456, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 3.14159, 4.56789, 5.67891, 6.78912, 7.89123, 8.91234,
  9.02345, 0.13456, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 1.24567, 2.35678, 3.46789, 4.57891, 5.68912, 6.79123,
  7.81234, 8.92345, 9.03456, 0.14567, 1.25678, 2.36789, 3.47891, 4.58912,
  5.69123, 6.79234, 7.80345, 8.91456, 9.02567, 0.13678, 1.24789, 2.35891,
  3.46912, 4.57123, 5.68234, 6.79345, 7.80456, 8.91567, 9.02678, 0.13789,
  1.24891, 2.35912, 3.46023, 4.57134,
];
console.log(data.length);
let typedData = new Float64Array(data);
let data_p = Module._exported_malloc(
  typedData.length * typedData.BYTES_PER_ELEMENT,
);
Module.HEAPF64.set(typedData, data_p / typedData.BYTES_PER_ELEMENT);

let compressed = [0];
// let typedCompressed = new Uint8Array(compressed);
let compressed_p = Module._exported_malloc(1024);
// Module.HEAP8.set(typedCompressed, compressed_p);

let outSize = [0];
let outSize_p = Module._exported_malloc(4);

let new_compressed_p = Module._sz_compress_f64(
  data_p,
  typedData.length,
  outSize_p,
);
// outSize = Module.HEAP32.subarray(
//   outSize_p / typedOutSize.BYTES_PER_ELEMENT,
//   outSize_p / typedOutSize.BYTES_PER_ELEMENT + typedOutSize.length,
// );
outSize = Module.HEAP32[outSize_p >> 2];
compressed = Module.HEAP8.subarray(
  new_compressed_p,
  new_compressed_p + outSize,
);
console.log(compressed);

let new_data_p = Module._exported_malloc(
  typedData.length * typedData.BYTES_PER_ELEMENT,
);

// Decompress
Module._sz_decompress_f64(
  new_compressed_p,
  outSize,
  new_data_p,
  typedData.length,
);
let new_data = Module.HEAPF64.subarray(
  new_data_p / typedData.BYTES_PER_ELEMENT,
  new_data_p / typedData.BYTES_PER_ELEMENT + typedData.length,
);
console.log(new_data);
